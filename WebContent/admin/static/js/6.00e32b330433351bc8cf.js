webpackJsonp([6,12],{DWtw:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("SG/P"),i=(s("MJ8A"),{name:"UserManage",components:{UserForm:a.default},data:function(){return{expand:!1,search:"",totalItems:0,items:[],loading:!0,pagination:{},headers:[{text:"uid",align:"center",value:"uid",sortable:!1},{text:"用户名",align:"center",sortable:!1,value:"name"},{text:"邮箱",align:"center",sortable:!1,value:"email"},{text:"角色",align:"center",value:"role",sortable:!1},{text:"操作",align:"center",value:"uid",sortable:!1}],show:!1,user:{},isEdit:!1}},watch:{search:{handler:function(){this.getDataFromApi()}},show:function(e,t){t&&this.getDataFromApi()}},mounted:function(){this.getDataFromApi()},methods:{addUser:function(){this.user={},this.isEdit=!1,this.show=!0},editUser:function(e){this.user=e,this.isEdit=!0,this.show=!0},deleteUser:function(e){var t=this;this.$message.confirm("此操作将永久删除该品牌, 是否继续?").then(function(){t.$http.get("/UserManage/delete?uid="+e.uid).then(function(){t.$message.success("删除成功！"),t.getDataFromApi()}).catch(function(){t.$message.info("操作异常！")})}).catch(function(){t.$message.info("删除已取消！")})},getDataFromApi:function(){var e=this;this.loading=!0,this.$http.get("/UserManage/list").then(function(t){e.items=t.data,e.loading=!1}).catch(function(t){e.$message.info("获取数据失败！")})}}}),r={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-card",[s("v-card-title",[s("v-btn",{attrs:{color:"primary"},on:{click:e.addUser}},[e._v("新增用户")]),e._v(" "),s("v-spacer"),e._v(" "),s("v-text-field",{attrs:{"append-icon":"search",label:"搜索","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),e._v(" "),s("v-divider"),e._v(" "),s("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.items,"total-items":e.totalItems,loading:e.loading,"item-key":"uid","hide-actions":""},scopedSlots:e._u([{key:"items",fn:function(t){return[s("tr",{on:{click:function(e){t.expanded=!t.expanded}}},[s("td",{staticClass:"text-xs-center"},[e._v(e._s(t.item.uid))]),e._v(" "),s("td",{staticClass:"text-xs-center"},[e._v(e._s(t.item.name))]),e._v(" "),s("td",{staticClass:"text-xs-center"},[e._v(e._s(t.item.email))]),e._v(" "),s("td",{staticClass:"text-xs-center"},[e._v(e._s(t.item.role))]),e._v(" "),s("td",{staticClass:"justify-center layout px-0"},[s("v-btn",{attrs:{icon:""},on:{click:function(s){return s.stopPropagation(),e.editUser(t.item)}}},[s("i",{staticClass:"el-icon-edit"})]),e._v(" "),s("v-btn",{attrs:{icon:""},on:{click:function(s){return s.stopPropagation(),e.deleteUser(t.item)}}},[s("i",{staticClass:"el-icon-delete"})])],1)])]}},{key:"expand",fn:function(t){return[s("v-card",{attrs:{flat:""}},[s("v-card-text",{staticClass:"text-xs-center"},[e._v(e._s(t.item.password))])],1)]}}])},[e._v(" "),e._v(" "),s("template",{slot:"no-data"},[s("v-alert",{attrs:{value:!0,color:"info",icon:"info",outline:""}},[e._v("\n        数据正在加载中\n      ")])],1)],2),e._v(" "),e.show?s("v-dialog",{attrs:{"max-width":"600",scrollable:""},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[s("v-card",[s("v-toolbar",{attrs:{dark:"",dense:"",color:"primary"}},[s("v-toolbar-title",[e._v(e._s(e.isEdit?"修改用户":"新增用户"))]),e._v(" "),s("v-spacer"),e._v(" "),s("v-btn",{attrs:{icon:""},on:{click:function(t){e.show=!1}}},[s("v-icon",[e._v("close")])],1)],1),e._v(" "),s("v-card-text",{staticClass:"px-5 py-2"},[s("user-form",{attrs:{oldUser:e.user,isEdit:e.isEdit,reload:e.getDataFromApi},on:{close:function(t){e.show=!1}}})],1)],1)],1):e._e()],1)},staticRenderFns:[]};var n=s("C7Lr")(i,r,!1,function(e){s("H2bo")},"data-v-724fba3f",null);t.default=n.exports},H2bo:function(e,t){},"SG/P":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={name:"user-form",props:{oldUser:Object,isEdit:{type:Boolean,default:!1},show:{type:Boolean,default:!0}},data:function(){return{items:["普通用户","管理员"],valid:!1,user:{uid:"",password:"",name:"",email:"",role:""}}},watch:{oldUser:{immediate:!0,deep:!0,handler:function(e){this.user=Object.deepCopy(e)}}},methods:{submit:function(){var e=this;if(this.$refs.userForm.validate()){switch(this.user.role){case"普通用户":this.user.rid=1;break;case"管理员":this.user.rid=2;break;default:this.user.rid=1}this.isEdit&&(this.user.oldemail=this.oldUser.email),this.$http.post(this.isEdit?"/UserManage/edit":"/UserManage/add",this.$qs.stringify(this.user)).then(function(){e.$message.success("保存成功！"),e.closeWindow()}).catch(function(){e.$message.error("保存失败:邮箱已存在！")})}},clear:function(){this.$refs.userForm.reset()},closeWindow:function(){this.$emit("close")}}},i={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-form",{ref:"userForm",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[s("v-text-field",{attrs:{label:"用户名",rules:[function(e){return!!e||"用户名不能为空"}],counter:10,required:""},model:{value:e.user.name,callback:function(t){e.$set(e.user,"name",t)},expression:"user.name"}}),e._v(" "),s("v-text-field",{attrs:{label:"邮箱",rules:[function(e){return!!e||"邮箱不能为空"}],required:""},model:{value:e.user.email,callback:function(t){e.$set(e.user,"email",t)},expression:"user.email"}}),e._v(" "),s("v-text-field",{attrs:{label:"密码",rules:[function(e){return!!e||"密码不能为空"}],required:""},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}}),e._v(" "),s("v-select",{attrs:{items:e.items,label:"角色*"},model:{value:e.user.role,callback:function(t){e.$set(e.user,"role",t)},expression:"user.role"}}),e._v(" "),s("v-layout",{staticClass:"my-4"},[s("v-btn",{attrs:{color:"primary"},on:{click:e.submit}},[e._v("提交")]),e._v(" "),s("v-btn",{attrs:{color:"warning"},on:{click:e.clear}},[e._v("重置")])],1)],1)},staticRenderFns:[]};var r=s("C7Lr")(a,i,!1,function(e){s("jq2n")},"data-v-21a9a407",null);t.default=r.exports},jq2n:function(e,t){}});
//# sourceMappingURL=6.00e32b330433351bc8cf.js.map