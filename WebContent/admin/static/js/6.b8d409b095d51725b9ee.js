webpackJsonp([6,11],{"3UQm":function(t,e){},dBdl:function(t,e){},mWTg:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});s("3f40"),s("4qOc"),s("+cgv");var o=s("G0J2"),a={name:"goods-form",components:{quillEditor:o.quillEditor},props:{step:{type:Number,default:1},isEdit:{type:Boolean,default:!1},oldGoods:Object},data:function(){return{valid:!1,headers:[],goods:{pid:"",pname:"",pstarlevel:"",ptype:"",pnewprice:"",poldprice:"",pinfo:"",plable:"",productImgs:[]}}},methods:{deleteOption:function(t,e){this.skuTemplate[t].options.splice(e,1)},listupload:function(t){this.goods.productImgs=t,console.log(this.goods.productImgs)},submit:function(){var t=this;this.goods.productImgs=this.goods.productImgs.map(function(t){return t.imgurl}),this.goods.productImgs=this.goods.productImgs&&this.goods.productImgs.length>0?this.goods.productImgs.join(","):"",this.goods.productImgs.length<=0?this.$message.error("至少选择一张图片！"):(console.log(this.goods.productImgs),this.$http.post(this.isEdit?"/ProductManage/edit":"/ProductManage/add",this.$qs.stringify(this.goods)).then(function(){t.$message.success("提交商品成功！"),t.$emit("closeForm")}).catch(function(e){console.log(e),t.$message.error("提交商品失败！"),t.$emit("closeForm")}))}},watch:{oldGoods:{immediate:!0,deep:!0,handler:function(t){null!=t&&this.isEdit&&(this.goods=Object.deepCopy(t))}}}},i={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-stepper",{attrs:{value:t.step}},[s("v-stepper-header",[s("v-stepper-step",{attrs:{step:"1",complete:t.step>1}},[t._v("基本信息")]),t._v(" "),s("v-divider"),t._v(" "),s("v-stepper-step",{attrs:{step:"2",complete:t.step>2}},[t._v("商品描述")]),t._v(" "),s("v-divider"),t._v(" "),s("v-stepper-step",{attrs:{step:"3"}},[t._v("商品图片")])],1),t._v(" "),s("v-stepper-items",[s("v-stepper-content",{attrs:{step:"1"}},[s("v-layout",{attrs:{"justify-center":""}},[s("v-flex",{attrs:{xs10:""}},[s("v-form",{ref:"basic",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[s("v-layout",{attrs:{row:""}},[s("v-flex",{attrs:{xs5:""}},[s("v-text-field",{attrs:{label:"商品分类",required:"",rules:[function(t){return!!t||"商品分类不能为空"}]},model:{value:t.goods.ptype,callback:function(e){t.$set(t.goods,"ptype",e)},expression:"goods.ptype"}})],1),t._v(" "),s("v-flex",{attrs:{"offset-xs2":"",xs5:""}},[s("v-text-field",{attrs:{label:"商品标签",required:"",rules:[function(t){return!!t||"商品标签不能为空"}]},model:{value:t.goods.plabel,callback:function(e){t.$set(t.goods,"plabel",e)},expression:"goods.plabel"}})],1)],1),t._v(" "),s("v-text-field",{attrs:{label:"商品名称",required:"",rules:[function(t){return!!t||"商品标题不能为空"}]},model:{value:t.goods.pname,callback:function(e){t.$set(t.goods,"pname",e)},expression:"goods.pname"}}),t._v(" "),s("v-layout",{attrs:{row:""}},[s("v-flex",{attrs:{xs5:""}},[s("v-text-field",{attrs:{label:"商品原价",required:"",rules:[function(t){return!!t||"商品原价不能为空"}],mask:"######"},model:{value:t.goods.poldprice,callback:function(e){t.$set(t.goods,"poldprice",e)},expression:"goods.poldprice"}})],1),t._v(" "),s("v-flex",{attrs:{"offset-xs2":"",xs5:""}},[s("v-text-field",{attrs:{label:"商品现价",required:"",rules:[function(t){return!!t||"商品现价不能为空"}],mask:"######"},model:{value:t.goods.pnewprice,callback:function(e){t.$set(t.goods,"pnewprice",e)},expression:"goods.pnewprice"}})],1)],1),t._v(" "),s("v-text-field",{attrs:{label:"商品星级",rules:[function(t){return t>-1&&t<=5||"商品星级不能为空且不能大于5"}],mask:"#"},model:{value:t.goods.pstarlevel,callback:function(e){t.$set(t.goods,"pstarlevel",e)},expression:"goods.pstarlevel"}}),t._v(" "),s("v-layout",{attrs:{row:""}},[s("v-flex",{attrs:{xs3:""}}),t._v(" "),s("v-flex")],1)],1)],1)],1)],1),t._v(" "),s("v-stepper-content",{attrs:{step:"2"}},[s("v-editor",{attrs:{"upload-url":"/Upload/image"},model:{value:t.goods.pinfo,callback:function(e){t.$set(t.goods,"pinfo",e)},expression:"goods.pinfo"}})],1),t._v(" "),s("v-stepper-content",{attrs:{step:"3"}},[s("v-layout",{attrs:{row:""}},[s("v-flex",{attrs:{xs3:""}},[s("span",{staticStyle:{"font-size":"16px",color:"#444"}},[t._v("商品图片：")])]),t._v(" "),s("v-flex",[s("v-upload",{attrs:{url:"/Upload/image",multiple:!0,"pic-width":250,"pic-height":90},on:{input:t.listupload},model:{value:t.goods.productImgs,callback:function(e){t.$set(t.goods,"productImgs",e)},expression:"goods.productImgs"}})],1)],1)],1)],1)],1)},staticRenderFns:[]};var n=s("VU/8")(a,i,!1,function(t){s("dBdl")},"data-v-6c2bc9da",null);e.default=n.exports},priW:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=s("mWTg"),a=(s("QmSG"),{name:"item",components:{GoodsForm:o.default},data:function(){return{imgurl:"http://47.100.52.248/cart/assets/images/products/single/product-shop-1-2.jpg",expand:!1,search:{key:"",saleable:!0},totalItems:0,items:[],loading:!0,pagination:{},headers:[{text:"pid",align:"center",value:"id",sortable:!1},{text:"名称",align:"center",sortable:!1,value:"name"},{text:"分类",align:"center",sortable:!1,value:"image"},{text:"价格",align:"center",value:"letter",sortable:!1},{text:"操作",align:"center",value:"id",sortable:!1}],show:!1,selectedGoods:null,isEdit:!1,step:1}},watch:{pagination:{handler:function(){this.getDataFromApi()},deep:!0},search:{handler:function(){this.getDataFromApi()},deep:!0}},mounted:function(){this.getDataFromApi()},methods:{closeForm:function(){this.isEdit=!1,this.show=!1,this.step=1,this.selectedGoods=null,this.getDataFromApi()},lastStep:function(){1!==this.step&&this.step--},nextStep:function(){4!==this.step&&this.$refs.goodsForm.$refs.basic.validate()&&this.step++},submit:function(){this.$refs.goodsForm.submit()},addItem:function(){this.selectedGoods=null,this.isEdit=!1,this.show=!0},editItem:function(t){this.selectedGoods=t,this.isEdit=!0,this.show=!0},deleteItem:function(t){var e=this;this.$message.confirm("此操作将永久删除该商品, 是否继续?").then(function(){e.$http.delete("/ProductManage/delete?pid="+t).then(function(){e.getDataFromApi(),e.$message.info("删除成功!")})}).catch(function(){e.$message.info("已取消删除")})},getDataFromApi:function(){var t=this;this.loading=!0,this.$http.get("/ProductManage/list").then(function(e){t.items=e.data,t.loading=!1}).catch(function(e){t.$message.info("获取数据失败！")})}}}),i={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-card",[s("v-toolbar",{staticClass:"elevation-0"},[s("v-btn",{attrs:{color:"primary"},on:{click:t.addItem}},[t._v("新增商品")]),t._v(" "),s("v-spacer"),t._v(" "),s("v-flex",{attrs:{xs3:""}},[t._v("\n      状态：\n      "),s("v-btn-toggle",{attrs:{mandatory:""},model:{value:t.search.saleable,callback:function(e){t.$set(t.search,"saleable",e)},expression:"search.saleable"}},[s("v-btn",{attrs:{flat:""}},[t._v("\n          全部\n        ")]),t._v(" "),s("v-btn",{attrs:{flat:"",value:!0}},[t._v("\n          上架\n        ")]),t._v(" "),s("v-btn",{attrs:{flat:"",value:!1}},[t._v("\n          下架\n        ")])],1)],1),t._v(" "),s("v-flex",{attrs:{xs3:""}},[s("v-text-field",{attrs:{"append-icon":"search",label:"搜索","single-line":"","hide-details":""},model:{value:t.search.key,callback:function(e){t.$set(t.search,"key",e)},expression:"search.key"}})],1)],1),t._v(" "),s("v-divider"),t._v(" "),s("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.items,"total-items":t.totalItems,loading:t.loading,"item-key":"pid","hide-actions":""},scopedSlots:t._u([{key:"items",fn:function(e){return[s("tr",{on:{click:function(t){e.expanded=!e.expanded}}},[s("td",{staticClass:"text-xs-center"},[t._v(t._s(e.item.pid))]),t._v(" "),s("td",{staticClass:"text-xs-center"},[t._v(t._s(e.item.pname))]),t._v(" "),s("td",{staticClass:"text-xs-center"},[t._v(t._s(e.item.ptype))]),t._v(" "),s("td",{staticClass:"text-xs-center"},[t._v("$"+t._s(e.item.pnewprice))]),t._v(" "),s("td",{staticClass:"justify-center layout px-0"},[s("v-btn",{attrs:{icon:"",small:""},on:{click:function(s){s.stopPropagation(),t.editItem(e.item)}}},[s("i",{staticClass:"el-icon-edit"})]),t._v(" "),s("v-btn",{attrs:{icon:"",small:""},on:{click:function(s){s.stopPropagation(),t.deleteItem(e.item.pid)}}},[s("i",{staticClass:"el-icon-delete"})])],1)])]}},{key:"expand",fn:function(e){return[s("v-card",{attrs:{flat:""}},[s("v-card-text",{staticClass:"text-xs-left"},[t._v(t._s(e.item.pinfo))])],1)]}}])},[s("template",{slot:"no-data"},[s("v-alert",{attrs:{value:!0,color:"info",icon:"info",outline:""}},[t._v("\n        数据正在加载中\n      ")])],1)],2),t._v(" "),t.show?s("v-dialog",{attrs:{"max-width":"900",scrollable:"",persistent:""},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[s("v-card",[s("v-toolbar",{attrs:{dense:"",dark:"",color:"primary"}},[s("v-toolbar-title",[t._v(t._s(t.isEdit?"修改商品":"新增商品"))]),t._v(" "),s("v-spacer"),t._v(" "),s("v-btn",{attrs:{icon:""},on:{click:t.closeForm}},[s("v-icon",[t._v("close")])],1)],1),t._v(" "),s("v-card-text",{staticStyle:{height:"600px"}},[s("goods-form",{ref:"goodsForm",attrs:{oldGoods:t.selectedGoods,isEdit:t.isEdit,step:t.step},on:{closeForm:t.closeForm}})],1),t._v(" "),s("v-card-actions",[s("v-layout",{attrs:{row:"","justify-center":""}},[s("v-flex",{attrs:{xs2:""}},[s("v-btn",{attrs:{disabled:1===t.step},on:{click:t.lastStep}},[t._v("上一步")])],1),t._v(" "),s("v-flex",{attrs:{xs2:""}},[3===t.step?s("v-btn",{attrs:{color:"primary"},on:{click:t.submit}},[t._v("完成")]):s("v-btn",{attrs:{color:"primary"},on:{click:t.nextStep}},[t._v("下一步")])],1)],1)],1)],1)],1):t._e()],1)},staticRenderFns:[]};var n=s("VU/8")(a,i,!1,function(t){s("3UQm")},"data-v-feccc08a",null);e.default=n.exports}});
//# sourceMappingURL=6.b8d409b095d51725b9ee.js.map