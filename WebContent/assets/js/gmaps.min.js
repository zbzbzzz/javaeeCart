"use strict";!function(d,c){"object"==typeof exports?module.exports=c():"function"==typeof define&&define.amd?define(["jquery","googlemaps!"],c):d.GMaps=c()}(this,function(){var w=function(f,d){var g;if(f===d){return f}for(g in d){void 0!==d[g]&&(f[g]=d[g])}return f},v=function(h,g){var l,k=Array.prototype.slice.call(arguments,2),j=[],i=h.length;if(Array.prototype.map&&h.map===Array.prototype.map){j=Array.prototype.map.call(h,function(b){var d=k.slice(0);return d.splice(0,0,b),g.apply(this,d)})}else{for(l=0;l<i;l++){callback_params=k,callback_params.splice(0,0,h[l]),j.push(g.apply(this,callback_params))}}return j},u=function(f){var d,g=[];for(d=0;d<f.length;d++){g=g.concat(f[d])}return g},t=function(g,f){var i=g[0],h=g[1];return f&&(i=g[1],h=g[0]),new google.maps.LatLng(i,h)},s=function(f,d){var g;for(g=0;g<f.length;g++){f[g] instanceof google.maps.LatLng||(f[g].length>0&&"object"==typeof f[g][0]?f[g]=s(f[g],d):f[g]=t(f[g],d))}return f},r=function(f,d){var g=f.replace(".","");return"jQuery" in this&&d?$("."+g,d)[0]:document.getElementsByClassName(g)[0]},q=function(d,c){var d=d.replace("#","");return"jQuery" in window&&c?$("#"+d,c)[0]:document.getElementById(d)},p=function(h){var g=0,l=0;if(h.getBoundingClientRect){var k=h.getBoundingClientRect(),j=-(window.scrollX?window.scrollX:window.pageXOffset),i=-(window.scrollY?window.scrollY:window.pageYOffset);return[k.left-j,k.top-i]}if(h.offsetParent){do{g+=h.offsetLeft,l+=h.offsetTop}while(h=h.offsetParent)}return[g,l]},o=function(a){var g=document,f=function(ah){if("object"!=typeof window.google||!window.google.maps){return"object"==typeof window.console&&window.console.error&&console.error("Google Maps API is required. Please register the following JavaScript library https://maps.googleapis.com/maps/api/js."),function(){}}if(!this){return new f(ah)}ah.zoom=ah.zoom||15,ah.mapType=ah.mapType||"roadmap";var ag,af=function(k,j){return void 0===k?j:k},ae=this,ad=["bounds_changed","center_changed","click","dblclick","drag","dragend","dragstart","idle","maptypeid_changed","projection_changed","resize","tilesloaded","zoom_changed"],ac=["mousemove","mouseout","mouseover"],ab=["el","lat","lng","mapType","width","height","markerClusterer","enableNewStyle"],aa=ah.el||ah.div,Z=ah.markerClusterer,Y=google.maps.MapTypeId[ah.mapType.toUpperCase()],W=new google.maps.LatLng(ah.lat,ah.lng),U=af(ah.zoomControl,!0),S=ah.zoomControlOpt||{style:"DEFAULT",position:"TOP_LEFT"},Q=S.style||"DEFAULT",O=S.position||"TOP_LEFT",M=af(ah.panControl,!0),K=af(ah.mapTypeControl,!0),i=af(ah.scaleControl,!0),d=af(ah.streetViewControl,!0),c=af(c,!0),X={},V={zoom:this.zoom,center:W,mapTypeId:Y},T={panControl:M,zoomControl:U,zoomControlOptions:{style:google.maps.ZoomControlStyle[Q],position:google.maps.ControlPosition[O]},mapTypeControl:K,scaleControl:i,streetViewControl:d,overviewMapControl:c};if("string"==typeof ah.el||"string"==typeof ah.div?aa.indexOf("#")>-1?this.el=q(aa,ah.context):this.el=r.apply(this,[aa,ah.context]):this.el=aa,void 0===this.el||null===this.el){throw"No element defined."}for(window.context_menu=window.context_menu||{},window.context_menu[ae.el.id]={},this.controls=[],this.overlays=[],this.layers=[],this.singleLayers={},this.markers=[],this.polylines=[],this.routes=[],this.polygons=[],this.infoWindow=null,this.overlay_el=null,this.zoom=ah.zoom,this.registered_events={},this.el.style.width=ah.width||this.el.scrollWidth||this.el.offsetWidth,this.el.style.height=ah.height||this.el.scrollHeight||this.el.offsetHeight,google.maps.visualRefresh=ah.enableNewStyle,ag=0;ag<ab.length;ag++){delete ah[ab[ag]]}for(1!=ah.disableDefaultUI&&(V=w(V,T)),X=w(V,ah),ag=0;ag<ad.length;ag++){delete X[ad[ag]]}for(ag=0;ag<ac.length;ag++){delete X[ac[ag]]}this.map=new google.maps.Map(this.el,X),Z&&(this.markerClusterer=Z.apply(this,[this.map]));var R=function(ai,I){var H="",G=window.context_menu[ae.el.id][ai];for(var F in G){if(G.hasOwnProperty(F)){var E=G[F];H+='<li><a id="'+ai+"_"+F+'" href="#">'+E.title+"</a></li>"}}if(q("gmaps_context_menu")){var D=q("gmaps_context_menu");D.innerHTML=H;var F,C=D.getElementsByTagName("a"),B=C.length;for(F=0;F<B;F++){var A=C[F],z=function(b){b.preventDefault(),G[this.id.replace(ai+"_","")].action.apply(ae,[I]),ae.hideContextMenu()};google.maps.event.clearListeners(A,"click"),google.maps.event.addDomListenerOnce(A,"click",z,!1)}var y=p.apply(this,[ae.el]),x=y[0]+I.pixel.x-15,j=y[1]+I.pixel.y-15;D.style.left=x+"px",D.style.top=j+"px"}};this.buildContextMenu=function(k,j){if("marker"===k){j.pixel={};var x=new google.maps.OverlayView;x.setMap(ae.map),x.draw=function(){var y=x.getProjection(),b=j.marker.getPosition();j.pixel=y.fromLatLngToContainerPixel(b),R(k,j)}}else{R(k,j)}var l=q("gmaps_context_menu");setTimeout(function(){l.style.display="block"},0)},this.setContextMenu=function(k){window.context_menu[ae.el.id][k.control]={};var j,y=g.createElement("ul");for(j in k.options){if(k.options.hasOwnProperty(j)){var x=k.options[j];window.context_menu[ae.el.id][k.control][x.name]={title:x.title,action:x.action}}}y.id="gmaps_context_menu",y.style.display="none",y.style.position="absolute",y.style.minWidth="100px",y.style.background="white",y.style.listStyle="none",y.style.padding="8px",y.style.boxShadow="2px 2px 6px #ccc",q("gmaps_context_menu")||g.body.appendChild(y);var l=q("gmaps_context_menu");google.maps.event.addDomListener(l,"mouseout",function(b){b.relatedTarget&&this.contains(b.relatedTarget)||window.setTimeout(function(){l.style.display="none"},400)},!1)},this.hideContextMenu=function(){var b=q("gmaps_context_menu");b&&(b.style.display="none")};var P=function(b,j){google.maps.event.addListener(b,j,function(k){void 0==k&&(k=this),ah[j].apply(this,[k]),ae.hideContextMenu()})};google.maps.event.addListener(this.map,"zoom_changed",this.hideContextMenu);for(var N=0;N<ad.length;N++){var L=ad[N];L in ah&&P(this.map,L)}for(var N=0;N<ac.length;N++){var L=ac[N];L in ah&&P(this.map,L)}google.maps.event.addListener(this.map,"rightclick",function(b){ah.rightclick&&ah.rightclick.apply(this,[b]),void 0!=window.context_menu[ae.el.id].map&&ae.buildContextMenu("map",b)}),this.refresh=function(){google.maps.event.trigger(this.map,"resize")},this.fitZoom=function(){var k,j=[],l=this.markers.length;for(k=0;k<l;k++){"boolean"==typeof this.markers[k].visible&&this.markers[k].visible&&j.push(this.markers[k].getPosition())}this.fitLatLngBounds(j)},this.fitLatLngBounds=function(k){var j,x=k.length,l=new google.maps.LatLngBounds;for(j=0;j<x;j++){l.extend(k[j])}this.map.fitBounds(l)},this.setCenter=function(k,j,l){this.map.panTo(new google.maps.LatLng(k,j)),l&&l()},this.getElement=function(){return this.el},this.zoomIn=function(b){b=b||1,this.zoom=this.map.getZoom()+b,this.map.setZoom(this.zoom)},this.zoomOut=function(b){b=b||1,this.zoom=this.map.getZoom()-b,this.map.setZoom(this.zoom)};var J,h=[];for(J in this.map){"function"!=typeof this.map[J]||this[J]||h.push(J)}for(ag=0;ag<h.length;ag++){!function(k,j,l){k[l]=function(){return j[l].apply(j,arguments)}}(this,this.map,h[ag])}};return f}(this);o.prototype.createControl=function(g){var f=document.createElement("div");f.style.cursor="pointer",g.disableDefaultStyles!==!0&&(f.style.fontFamily="Roboto, Arial, sans-serif",f.style.fontSize="11px",f.style.boxShadow="rgba(0, 0, 0, 0.298039) 0px 1px 4px -1px");for(var i in g.style){f.style[i]=g.style[i]}g.id&&(f.id=g.id),g.title&&(f.title=g.title),g.classes&&(f.className=g.classes),g.content&&("string"==typeof g.content?f.innerHTML=g.content:g.content instanceof HTMLElement&&f.appendChild(g.content)),g.position&&(f.position=google.maps.ControlPosition[g.position.toUpperCase()]);for(var h in g.events){!function(a,d){google.maps.event.addDomListener(a,d,function(){g.events[d].apply(this,[this])})}(f,h)}return f.index=1,f},o.prototype.addControl=function(d){var c=this.createControl(d);return this.controls.push(c),this.map.controls[c.position].push(c),c},o.prototype.removeControl=function(g){var f,i=null;for(f=0;f<this.controls.length;f++){this.controls[f]==g&&(i=this.controls[f].position,this.controls.splice(f,1))}if(i){for(f=0;f<this.map.controls.length;f++){var h=this.map.controls[g.position];if(h.getAt(f)==g){h.removeAt(f);break}}}return g},o.prototype.createMarker=function(H){if(void 0==H.lat&&void 0==H.lng&&void 0==H.position){throw"No latitude or longitude defined."}var G=this,F=H.details,E=H.fences,D=H.outside,C={position:new google.maps.LatLng(H.lat,H.lng),map:null},B=w(C,H);delete B.lat,delete B.lng,delete B.fences,delete B.outside;var A=new google.maps.Marker(B);if(A.fences=E,H.infoWindow){A.infoWindow=new google.maps.InfoWindow(H.infoWindow);for(var z=["closeclick","content_changed","domready","position_changed","zindex_changed"],y=0;y<z.length;y++){!function(b,d){H.infoWindow[d]&&google.maps.event.addListener(b,d,function(c){H.infoWindow[d].apply(this,[c])})}(A.infoWindow,z[y])}}for(var x=["animation_changed","clickable_changed","cursor_changed","draggable_changed","flat_changed","icon_changed","position_changed","shadow_changed","shape_changed","title_changed","visible_changed","zindex_changed"],a=["dblclick","drag","dragend","dragstart","mousedown","mouseout","mouseover","mouseup"],y=0;y<x.length;y++){!function(b,d){H[d]&&google.maps.event.addListener(b,d,function(){H[d].apply(this,[this])})}(A,x[y])}for(var y=0;y<a.length;y++){!function(b,g,f){H[f]&&google.maps.event.addListener(g,f,function(d){d.pixel||(d.pixel=b.getProjection().fromLatLngToPoint(d.latLng)),H[f].apply(this,[d])})}(this.map,A,a[y])}return google.maps.event.addListener(A,"click",function(){this.details=F,H.click&&H.click.apply(this,[this]),A.infoWindow&&(G.hideInfoWindows(),A.infoWindow.open(G.map,A))}),google.maps.event.addListener(A,"rightclick",function(b){b.marker=this,H.rightclick&&H.rightclick.apply(this,[b]),void 0!=window.context_menu[G.el.id].marker&&G.buildContextMenu("marker",b)}),A.fences&&google.maps.event.addListener(A,"dragend",function(){G.checkMarkerGeofence(A,function(d,c){D(d,c)})}),A},o.prototype.addMarker=function(d){var c;if(d.hasOwnProperty("gm_accessors_")){c=d}else{if(!(d.hasOwnProperty("lat")&&d.hasOwnProperty("lng")||d.position)){throw"No latitude or longitude defined."}c=this.createMarker(d)}return c.setMap(this.map),this.markerClusterer&&this.markerClusterer.addMarker(c),this.markers.push(c),o.fire("marker_added",c,this),c},o.prototype.addMarkers=function(f){for(var d,g=0;d=f[g];g++){this.addMarker(d)}return this.markers},o.prototype.hideInfoWindows=function(){for(var d,c=0;d=this.markers[c];c++){d.infoWindow&&d.infoWindow.close()}},o.prototype.removeMarker=function(d){for(var c=0;c<this.markers.length;c++){if(this.markers[c]===d){this.markers[c].setMap(null),this.markers.splice(c,1),this.markerClusterer&&this.markerClusterer.removeMarker(d),o.fire("marker_removed",d,this);break}}return d},o.prototype.removeMarkers=function(g){var f=[];if(void 0===g){for(var j=0;j<this.markers.length;j++){var i=this.markers[j];i.setMap(null),o.fire("marker_removed",i,this)}this.markerClusterer&&this.markerClusterer.clearMarkers&&this.markerClusterer.clearMarkers(),this.markers=f}else{for(var j=0;j<g.length;j++){var h=this.markers.indexOf(g[j]);if(h>-1){var i=this.markers[h];i.setMap(null),this.markerClusterer&&this.markerClusterer.removeMarker(i),o.fire("marker_removed",i,this)}}for(var j=0;j<this.markers.length;j++){var i=this.markers[j];null!=i.getMap()&&f.push(i)}this.markers=f}},o.prototype.drawOverlay=function(f){var d=new google.maps.OverlayView,g=!0;return d.setMap(this.map),null!=f.auto_show&&(g=f.auto_show),d.onAdd=function(){var j=document.createElement("div");j.style.borderStyle="none",j.style.borderWidth="0px",j.style.position="absolute",j.style.zIndex=100,j.innerHTML=f.content,d.el=j,f.layer||(f.layer="overlayLayer");var i=this.getPanes(),h=i[f.layer],b=["contextmenu","DOMMouseScroll","dblclick","mousedown"];h.appendChild(j);for(var a=0;a<b.length;a++){!function(k,c){google.maps.event.addDomListener(k,c,function(l){navigator.userAgent.toLowerCase().indexOf("msie")!=-1&&document.all?(l.cancelBubble=!0,l.returnValue=!1):l.stopPropagation()})}(j,b[a])}f.click&&(i.overlayMouseTarget.appendChild(d.el),google.maps.event.addDomListener(d.el,"click",function(){f.click.apply(d,[d])})),google.maps.event.trigger(this,"ready")},d.draw=function(){var l=this.getProjection(),k=l.fromLatLngToDivPixel(new google.maps.LatLng(f.lat,f.lng));f.horizontalOffset=f.horizontalOffset||0,f.verticalOffset=f.verticalOffset||0;var j=d.el,c=j.children[0],b=c.clientHeight,a=c.clientWidth;switch(f.verticalAlign){case"top":j.style.top=k.y-b+f.verticalOffset+"px";break;default:case"middle":j.style.top=k.y-b/2+f.verticalOffset+"px";break;case"bottom":j.style.top=k.y+f.verticalOffset+"px"}switch(f.horizontalAlign){case"left":j.style.left=k.x-a+f.horizontalOffset+"px";break;default:case"center":j.style.left=k.x-a/2+f.horizontalOffset+"px";break;case"right":j.style.left=k.x+f.horizontalOffset+"px"}j.style.display=g?"block":"none",g||f.show.apply(this,[j])},d.onRemove=function(){var a=d.el;f.remove?f.remove.apply(this,[a]):(d.el.parentNode.removeChild(d.el),d.el=null)},this.overlays.push(d),d},o.prototype.removeOverlay=function(d){for(var c=0;c<this.overlays.length;c++){if(this.overlays[c]===d){this.overlays[c].setMap(null),this.overlays.splice(c,1);break}}},o.prototype.removeOverlays=function(){for(var d,c=0;d=this.overlays[c];c++){d.setMap(null)}this.overlays=[]},o.prototype.drawPolyline=function(C){var B=[],A=C.path;if(A.length){if(void 0===A[0][0]){B=A}else{for(var z,y=0;z=A[y];y++){B.push(new google.maps.LatLng(z[0],z[1]))}}}var x={map:this.map,path:B,strokeColor:C.strokeColor,strokeOpacity:C.strokeOpacity,strokeWeight:C.strokeWeight,geodesic:C.geodesic,clickable:!0,editable:!1,visible:!0};C.hasOwnProperty("clickable")&&(x.clickable=C.clickable),C.hasOwnProperty("editable")&&(x.editable=C.editable),C.hasOwnProperty("icons")&&(x.icons=C.icons),C.hasOwnProperty("zIndex")&&(x.zIndex=C.zIndex);for(var l=new google.maps.Polyline(x),k=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],j=0;j<k.length;j++){!function(a,d){C[d]&&google.maps.event.addListener(a,d,function(c){C[d].apply(this,[c])})}(l,k[j])}return this.polylines.push(l),o.fire("polyline_added",l,this),l},o.prototype.removePolyline=function(d){for(var c=0;c<this.polylines.length;c++){if(this.polylines[c]===d){this.polylines[c].setMap(null),this.polylines.splice(c,1),o.fire("polyline_removed",d,this);break}}},o.prototype.removePolylines=function(){for(var d,c=0;d=this.polylines[c];c++){d.setMap(null)}this.polylines=[]},o.prototype.drawCircle=function(a){a=w({map:this.map,center:new google.maps.LatLng(a.lat,a.lng)},a),delete a.lat,delete a.lng;for(var h=new google.maps.Circle(a),g=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],f=0;f<g.length;f++){!function(b,d){a[d]&&google.maps.event.addListener(b,d,function(c){a[d].apply(this,[c])})}(h,g[f])}return this.polygons.push(h),h},o.prototype.drawRectangle=function(a){a=w({map:this.map},a);var j=new google.maps.LatLngBounds(new google.maps.LatLng(a.bounds[0][0],a.bounds[0][1]),new google.maps.LatLng(a.bounds[1][0],a.bounds[1][1]));a.bounds=j;for(var i=new google.maps.Rectangle(a),h=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],g=0;g<h.length;g++){!function(b,d){a[d]&&google.maps.event.addListener(b,d,function(c){a[d].apply(this,[c])})}(i,h[g])}return this.polygons.push(i),i},o.prototype.drawPolygon=function(j){var f=!1;j.hasOwnProperty("useGeoJSON")&&(f=j.useGeoJSON),delete j.useGeoJSON,j=w({map:this.map},j),0==f&&(j.paths=[j.paths.slice(0)]),j.paths.length>0&&j.paths[0].length>0&&(j.paths=u(v(j.paths,s,f)));for(var c=new google.maps.Polygon(j),b=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],a=0;a<b.length;a++){!function(g,d){j[d]&&google.maps.event.addListener(g,d,function(h){j[d].apply(this,[h])})}(c,b[a])}return this.polygons.push(c),o.fire("polygon_added",c,this),c},o.prototype.removePolygon=function(d){for(var c=0;c<this.polygons.length;c++){if(this.polygons[c]===d){this.polygons[c].setMap(null),this.polygons.splice(c,1),o.fire("polygon_removed",d,this);break}}},o.prototype.removePolygons=function(){for(var d,c=0;d=this.polygons[c];c++){d.setMap(null)}this.polygons=[]},o.prototype.getFromFusionTables=function(g){var f=g.events;delete g.events;var j=g,i=new google.maps.FusionTablesLayer(j);for(var h in f){!function(b,d){google.maps.event.addListener(b,d,function(c){f[d].apply(this,[c])})}(i,h)}return this.layers.push(i),i},o.prototype.loadFromFusionTables=function(d){var c=this.getFromFusionTables(d);return c.setMap(this.map),c},o.prototype.getFromKML=function(h){var g=h.url,l=h.events;delete h.url,delete h.events;var k=h,j=new google.maps.KmlLayer(g,k);for(var i in l){!function(d,c){google.maps.event.addListener(d,c,function(b){l[c].apply(this,[b])})}(j,i)}return this.layers.push(j),j},o.prototype.loadFromKML=function(d){var c=this.getFromKML(d);return c.setMap(this.map),c},o.prototype.addLayer=function(g,f){f=f||{};var j;switch(g){case"weather":this.singleLayers.weather=j=new google.maps.weather.WeatherLayer;break;case"clouds":this.singleLayers.clouds=j=new google.maps.weather.CloudLayer;break;case"traffic":this.singleLayers.traffic=j=new google.maps.TrafficLayer;break;case"transit":this.singleLayers.transit=j=new google.maps.TransitLayer;break;case"bicycling":this.singleLayers.bicycling=j=new google.maps.BicyclingLayer;break;case"panoramio":this.singleLayers.panoramio=j=new google.maps.panoramio.PanoramioLayer,j.setTag(f.filter),delete f.filter,f.click&&google.maps.event.addListener(j,"click",function(b){f.click(b),delete f.click});break;case"places":if(this.singleLayers.places=j=new google.maps.places.PlacesService(this.map),f.search||f.nearbySearch||f.radarSearch){var i={bounds:f.bounds||null,keyword:f.keyword||null,location:f.location||null,name:f.name||null,radius:f.radius||null,rankBy:f.rankBy||null,types:f.types||null};f.radarSearch&&j.radarSearch(i,f.radarSearch),f.search&&j.search(i,f.search),f.nearbySearch&&j.nearbySearch(i,f.nearbySearch)}if(f.textSearch){var h={bounds:f.bounds||null,location:f.location||null,query:f.query||null,radius:f.radius||null};j.textSearch(h,f.textSearch)}}if(void 0!==j){return"function"==typeof j.setOptions&&j.setOptions(f),"function"==typeof j.setMap&&j.setMap(this.map),j}},o.prototype.removeLayer=function(d){if("string"==typeof d&&void 0!==this.singleLayers[d]){this.singleLayers[d].setMap(null),delete this.singleLayers[d]}else{for(var c=0;c<this.layers.length;c++){if(this.layers[c]===d){this.layers[c].setMap(null),this.layers.splice(c,1);break}}}};var n,m;return o.prototype.getRoutes=function(a){switch(a.travelMode){case"bicycling":n=google.maps.TravelMode.BICYCLING;break;case"transit":n=google.maps.TravelMode.TRANSIT;break;case"driving":n=google.maps.TravelMode.DRIVING;break;default:n=google.maps.TravelMode.WALKING}m="imperial"===a.unitSystem?google.maps.UnitSystem.IMPERIAL:google.maps.UnitSystem.METRIC;var h={avoidHighways:!1,avoidTolls:!1,optimizeWaypoints:!1,waypoints:[]},g=w(h,a);g.origin=/string/.test(typeof a.origin)?a.origin:new google.maps.LatLng(a.origin[0],a.origin[1]),g.destination=/string/.test(typeof a.destination)?a.destination:new google.maps.LatLng(a.destination[0],a.destination[1]),g.travelMode=n,g.unitSystem=m,delete g.callback,delete g.error;var f=[];(new google.maps.DirectionsService).route(g,function(b,j){if(j===google.maps.DirectionsStatus.OK){for(var i in b.routes){b.routes.hasOwnProperty(i)&&f.push(b.routes[i])}a.callback&&a.callback(f,b,j)}else{a.error&&a.error(b,j)}})},o.prototype.removeRoutes=function(){this.routes.length=0},o.prototype.getElevations=function(f){f=w({locations:[],path:!1,samples:256},f),f.locations.length>0&&f.locations[0].length>0&&(f.locations=u(v([f.locations],s,!1)));var c=f.callback;delete f.callback;var b=new google.maps.ElevationService;if(f.path){var a={path:f.locations,samples:f.samples};b.getElevationAlongPath(a,function(g,d){c&&"function"==typeof c&&c(g,d)})}else{delete f.path,delete f.samples,b.getElevationForLocations(f,function(g,d){c&&"function"==typeof c&&c(g,d)})}},o.prototype.cleanRoute=o.prototype.removePolylines,o.prototype.renderRoute=function(a,h){var g,f="string"==typeof h.panel?document.getElementById(h.panel.replace("#","")):h.panel;h.panel=f,h=w({map:this.map},h),g=new google.maps.DirectionsRenderer(h),this.getRoutes({origin:a.origin,destination:a.destination,travelMode:a.travelMode,waypoints:a.waypoints,unitSystem:a.unitSystem,error:a.error,avoidHighways:a.avoidHighways,avoidTolls:a.avoidTolls,optimizeWaypoints:a.optimizeWaypoints,callback:function(i,d,j){j===google.maps.DirectionsStatus.OK&&g.setDirections(d)}})},o.prototype.drawRoute=function(d){var c=this;this.getRoutes({origin:d.origin,destination:d.destination,travelMode:d.travelMode,waypoints:d.waypoints,unitSystem:d.unitSystem,error:d.error,avoidHighways:d.avoidHighways,avoidTolls:d.avoidTolls,optimizeWaypoints:d.optimizeWaypoints,callback:function(b){if(b.length>0){var a={path:b[b.length-1].overview_path,strokeColor:d.strokeColor,strokeOpacity:d.strokeOpacity,strokeWeight:d.strokeWeight};d.hasOwnProperty("icons")&&(a.icons=d.icons),c.drawPolyline(a),d.callback&&d.callback(b[b.length-1])}}})},o.prototype.travelRoute=function(g){if(g.origin&&g.destination){this.getRoutes({origin:g.origin,destination:g.destination,travelMode:g.travelMode,waypoints:g.waypoints,unitSystem:g.unitSystem,error:g.error,callback:function(a){if(a.length>0&&g.start&&g.start(a[a.length-1]),a.length>0&&g.step){var x=a[a.length-1];if(x.legs.length>0){for(var l,k=x.legs[0].steps,j=0;l=k[j];j++){l.step_number=j,g.step(l,x.legs[0].steps.length-1)}}}a.length>0&&g.end&&g.end(a[a.length-1])}})}else{if(g.route&&g.route.legs.length>0){for(var f,i=g.route.legs[0].steps,h=0;f=i[h];h++){f.step_number=h,g.step(f)}}}},o.prototype.drawSteppedRoute=function(h){var g=this;if(h.origin&&h.destination){this.getRoutes({origin:h.origin,destination:h.destination,travelMode:h.travelMode,waypoints:h.waypoints,error:h.error,callback:function(A){if(A.length>0&&h.start&&h.start(A[A.length-1]),A.length>0&&h.step){var z=A[A.length-1];if(z.legs.length>0){for(var y,x=z.legs[0].steps,b=0;y=x[b];b++){y.step_number=b;var a={path:y.path,strokeColor:h.strokeColor,strokeOpacity:h.strokeOpacity,strokeWeight:h.strokeWeight};h.hasOwnProperty("icons")&&(a.icons=h.icons),g.drawPolyline(a),h.step(y,z.legs[0].steps.length-1)}}}A.length>0&&h.end&&h.end(A[A.length-1])}})}else{if(h.route&&h.route.legs.length>0){for(var l,k=h.route.legs[0].steps,j=0;l=k[j];j++){l.step_number=j;var i={path:l.path,strokeColor:h.strokeColor,strokeOpacity:h.strokeOpacity,strokeWeight:h.strokeWeight};h.hasOwnProperty("icons")&&(i.icons=h.icons),g.drawPolyline(i),h.step(l)}}}},o.Route=function(d){this.origin=d.origin,this.destination=d.destination,this.waypoints=d.waypoints,this.map=d.map,this.route=d.route,this.step_count=0,this.steps=this.route.legs[0].steps,this.steps_length=this.steps.length;var c={path:new google.maps.MVCArray,strokeColor:d.strokeColor,strokeOpacity:d.strokeOpacity,strokeWeight:d.strokeWeight};d.hasOwnProperty("icons")&&(c.icons=d.icons),this.polyline=this.map.drawPolyline(c).getPath()},o.Route.prototype.getRoute=function(d){var c=this;this.map.getRoutes({origin:this.origin,destination:this.destination,travelMode:d.travelMode,waypoints:this.waypoints||[],error:d.error,callback:function(){c.route=e[0],d.callback&&d.callback.call(c)}})},o.Route.prototype.back=function(){if(this.step_count>0){this.step_count--;var d=this.route.legs[0].steps[this.step_count].path;for(var c in d){d.hasOwnProperty(c)&&this.polyline.pop()}}},o.Route.prototype.forward=function(){if(this.step_count<this.steps_length){var d=this.route.legs[0].steps[this.step_count].path;for(var c in d){d.hasOwnProperty(c)&&this.polyline.push(d[c])}this.step_count++}},o.prototype.checkGeofence=function(f,d,g){return g.containsLatLng(new google.maps.LatLng(f,d))},o.prototype.checkMarkerGeofence=function(g,f){if(g.fences){for(var j,i=0;j=g.fences[i];i++){var h=g.getPosition();this.checkGeofence(h.lat(),h.lng(),j)||f(g,j)}}},o.prototype.toImage=function(g){var g=g||{},f={};if(f.size=g.size||[this.el.clientWidth,this.el.clientHeight],f.lat=this.getCenter().lat(),f.lng=this.getCenter().lng(),this.markers.length>0){f.markers=[];for(var i=0;i<this.markers.length;i++){f.markers.push({lat:this.markers[i].getPosition().lat(),lng:this.markers[i].getPosition().lng()})}}if(this.polylines.length>0){var h=this.polylines[0];f.polyline={},f.polyline.path=google.maps.geometry.encoding.encodePath(h.getPath()),f.polyline.strokeColor=h.strokeColor,f.polyline.strokeOpacity=h.strokeOpacity,f.polyline.strokeWeight=h.strokeWeight}return o.staticMapURL(f)},o.staticMapURL=function(X){function W(d,c){if("#"===d[0]&&(d=d.replace("#","0x"),c)){if(c=parseFloat(c),0===(c=Math.min(1,Math.max(c,0)))){return"0x00000000"}c=(255*c).toString(16),1===c.length&&(c+=c),d=d.slice(0,8)+c}return d}var V,U=[],T=("file:"===location.protocol?"http:":location.protocol)+"//maps.googleapis.com/maps/api/staticmap";X.url&&(T=X.url,delete X.url),T+="?";var S=X.markers;delete X.markers,!S&&X.marker&&(S=[X.marker],delete X.marker);var R=X.styles;delete X.styles;var Q=X.polyline;if(delete X.polyline,X.center){U.push("center="+X.center),delete X.center}else{if(X.address){U.push("center="+X.address),delete X.address}else{if(X.lat){U.push(["center=",X.lat,",",X.lng].join("")),delete X.lat,delete X.lng}else{if(X.visible){var P=encodeURI(X.visible.join("|"));U.push("visible="+P)}}}}var O=X.size;O?(O.join&&(O=O.join("x")),delete X.size):O="630x300",U.push("size="+O),X.zoom||X.zoom===!1||(X.zoom=15);var N=!X.hasOwnProperty("sensor")||!!X.sensor;delete X.sensor,U.push("sensor="+N);for(var M in X){X.hasOwnProperty(M)&&U.push(M+"="+X[M])}if(S){for(var L,K,J=0;V=S[J];J++){L=[],V.size&&"normal"!==V.size?(L.push("size:"+V.size),delete V.size):V.icon&&(L.push("icon:"+encodeURI(V.icon)),delete V.icon),V.color&&(L.push("color:"+V.color.replace("#","0x")),delete V.color),V.label&&(L.push("label:"+V.label[0].toUpperCase()),delete V.label),K=V.address?V.address:V.lat+","+V.lng,delete V.address,delete V.lat,delete V.lng;for(var M in V){V.hasOwnProperty(M)&&L.push(M+":"+V[M])}L.length||0===J?(L.push(K),L=L.join("|"),U.push("markers="+encodeURI(L))):(L=U.pop()+encodeURI("|"+K),U.push(L))}}if(R){for(var J=0;J<R.length;J++){var I=[];R[J].featureType&&I.push("feature:"+R[J].featureType.toLowerCase()),R[J].elementType&&I.push("element:"+R[J].elementType.toLowerCase());for(var H=0;H<R[J].stylers.length;H++){for(var G in R[J].stylers[H]){var F=R[J].stylers[H][G];"hue"!=G&&"color"!=G||(F="0x"+F.substring(1)),I.push(G+":"+F)}}var E=I.join("|");""!=E&&U.push("style="+E)}}if(Q){if(V=Q,Q=[],V.strokeWeight&&Q.push("weight:"+parseInt(V.strokeWeight,10)),V.strokeColor){var D=W(V.strokeColor,V.strokeOpacity);Q.push("color:"+D)}if(V.fillColor){var C=W(V.fillColor,V.fillOpacity);Q.push("fillcolor:"+C)}var B=V.path;if(B.join){for(var A,H=0;A=B[H];H++){Q.push(A.join(","))}}else{Q.push("enc:"+B)}Q=Q.join("|"),U.push("path="+encodeURI(Q))}var z=window.devicePixelRatio||1;return U.push("scale="+z),U=U.join("&"),T+U},o.prototype.addMapType=function(f,d){if(!d.hasOwnProperty("getTileUrl")||"function"!=typeof d.getTileUrl){throw"'getTileUrl' function required."}d.tileSize=d.tileSize||new google.maps.Size(256,256);var g=new google.maps.ImageMapType(d);this.map.mapTypes.set(f,g)},o.prototype.addOverlayMapType=function(d){if(!d.hasOwnProperty("getTile")||"function"!=typeof d.getTile){throw"'getTile' function required."}var c=d.index;delete d.index,this.map.overlayMapTypes.insertAt(c,d)},o.prototype.removeOverlayMapType=function(b){this.map.overlayMapTypes.removeAt(b)},o.prototype.addStyle=function(d){var c=new google.maps.StyledMapType(d.styles,{name:d.styledMapName});this.map.mapTypes.set(d.mapTypeId,c)},o.prototype.setStyle=function(b){this.map.setMapTypeId(b)},o.prototype.createPanorama=function(b){return b.hasOwnProperty("lat")&&b.hasOwnProperty("lng")||(b.lat=this.getCenter().lat(),b.lng=this.getCenter().lng()),this.panorama=o.createPanorama(b),this.map.setStreetView(this.panorama),this.panorama},o.createPanorama=function(a){var l=q(a.el,a.context);a.position=new google.maps.LatLng(a.lat,a.lng),delete a.el,delete a.context,delete a.lat,delete a.lng;for(var k=["closeclick","links_changed","pano_changed","position_changed","pov_changed","resize","visible_changed"],j=w({visible:!0},a),i=0;i<k.length;i++){delete j[k[i]]}for(var h=new google.maps.StreetViewPanorama(l,j),i=0;i<k.length;i++){!function(b,d){a[d]&&google.maps.event.addListener(b,d,function(){a[d].apply(this)})}(h,k[i])}return h},o.prototype.on=function(d,c){return o.on(d,this,c)},o.prototype.off=function(b){o.off(b,this)},o.prototype.once=function(d,c){return o.once(d,this,c)},o.custom_events=["marker_added","marker_removed","polyline_added","polyline_removed","polygon_added","polygon_removed","geolocated","geolocation_failed"],o.on=function(g,f,i){if(o.custom_events.indexOf(g)==-1){return f instanceof o&&(f=f.map),google.maps.event.addListener(f,g,i)}var h={handler:i,eventName:g};return f.registered_events[g]=f.registered_events[g]||[],f.registered_events[g].push(h),h},o.off=function(d,c){o.custom_events.indexOf(d)==-1?(c instanceof o&&(c=c.map),google.maps.event.clearListeners(c,d)):c.registered_events[d]=[]},o.once=function(f,d,g){if(o.custom_events.indexOf(f)==-1){return d instanceof o&&(d=d.map),google.maps.event.addListenerOnce(d,f,g)}},o.fire=function(g,f,j){if(o.custom_events.indexOf(g)==-1){google.maps.event.trigger(f,g,Array.prototype.slice.apply(arguments).slice(2))}else{if(g in j.registered_events){for(var i=j.registered_events[g],h=0;h<i.length;h++){!function(k,d,l){k.apply(d,[l])}(i[h].handler,j,f)}}}},o.geolocate=function(d){var c=d.always||d.complete;navigator.geolocation?navigator.geolocation.getCurrentPosition(function(a){d.success(a),c&&c()},function(a){d.error(a),c&&c()},d.options):(d.not_supported(),c&&c())},o.geocode=function(d){this.geocoder=new google.maps.Geocoder;var c=d.callback;d.hasOwnProperty("lat")&&d.hasOwnProperty("lng")&&(d.latLng=new google.maps.LatLng(d.lat,d.lng)),delete d.lat,delete d.lng,delete d.callback,this.geocoder.geocode(d,function(b,f){c(b,f)})},"object"==typeof window.google&&window.google.maps&&(google.maps.Polygon.prototype.getBounds||(google.maps.Polygon.prototype.getBounds=function(h){for(var g,l=new google.maps.LatLngBounds,k=this.getPaths(),j=0;j<k.getLength();j++){g=k.getAt(j);for(var i=0;i<g.getLength();i++){l.extend(g.getAt(i))}}return l}),google.maps.Polygon.prototype.containsLatLng||(google.maps.Polygon.prototype.containsLatLng=function(G){var F=this.getBounds();if(null!==F&&!F.contains(G)){return !1}for(var E=!1,D=this.getPaths().getLength(),C=0;C<D;C++){for(var B=this.getPaths().getAt(C),A=B.getLength(),z=A-1,y=0;y<A;y++){var x=B.getAt(y),l=B.getAt(z);(x.lng()<G.lng()&&l.lng()>=G.lng()||l.lng()<G.lng()&&x.lng()>=G.lng())&&x.lat()+(G.lng()-x.lng())/(l.lng()-x.lng())*(l.lat()-x.lat())<G.lat()&&(E=!E),z=y}}return E}),google.maps.Circle.prototype.containsLatLng||(google.maps.Circle.prototype.containsLatLng=function(b){return !google.maps.geometry||google.maps.geometry.spherical.computeDistanceBetween(this.getCenter(),b)<=this.getRadius()}),google.maps.Rectangle.prototype.containsLatLng=function(b){return this.getBounds().contains(b)},google.maps.LatLngBounds.prototype.containsLatLng=function(b){return this.contains(b)},google.maps.Marker.prototype.setFences=function(b){this.fences=b},google.maps.Marker.prototype.addFence=function(b){this.fences.push(b)},google.maps.Marker.prototype.getId=function(){return this.__gm_id}),Array.prototype.indexOf||(Array.prototype.indexOf=function(g){if(null==this){throw new TypeError}var f=Object(this),j=f.length>>>0;if(0===j){return -1}var i=0;if(arguments.length>1&&(i=Number(arguments[1]),i!=i?i=0:0!=i&&i!=1/0&&i!=-(1/0)&&(i=(i>0||-1)*Math.floor(Math.abs(i)))),i>=j){return -1}for(var h=i>=0?i:Math.max(j-Math.abs(i),0);h<j;h++){if(h in f&&f[h]===g){return h}}return -1}),o});